<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>Segment Anything (SAM)</title>
    <script src="https://cdn.jsdelivr.net/npm/onnxruntime-web/dist/ort.min.js"></script>
    <script type="module">
        console.clear();
        import {loadSam, writeMaskToCanvas} from "https://raw.githubusercontent.com/GarciaLnk/segment-anything-web/main/dist/sam.js";

        const img = new Image();
        img.crossOrigin = "anonymous";
        img.src = "https://raw.githubusercontent.com/facebookresearch/segment-anything/main/notebooks/images/truck.jpg";
        img.onload = async () => {
            const canvasInput = document.getElementById("input");
            canvasInput.width = img.width;
            canvasInput.height = img.height;
            canvasInput.getContext("2d").drawImage(img, 0, 0);

            const {encoder, decoder} = await loadSam();
            const embedding = await encoder.embedImage(canvasInput);
            const mask = await decoder.segment({embedding, point: [350, 200]});
            writeMaskToCanvas(mask, document.getElementById("output"));
        }
    </script>
</head>
<body>
    <h3>Meta Segment Anything (Web)</h3>
    <canvas id="input"></canvas>
    <canvas id="output"></canvas>
</body>
</html>
