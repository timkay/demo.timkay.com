<!DOCTYPE html>
<html>
    <head>
        <title>WebSocket Demo</title>
        <link rel="stylesheet" href="style.css" />
    </head>
    <body>
        <pre id="console_say_output" style="position: fixed; bottom: 10px; left: 10px; right: 10px; border: thin solid gray; overflow: hidden; padding: 4px; background: #0001"></pre>
        <script src="jquery.js"></script>
        <script src="https://unpkg.com/@timkay/say@0.2.0/index.js"></script>
        <script src="weedit.js" defer></script>
        <h1>WebSocket Demo</h1>
        <button id="send">Send</button> <button id="close">Close</button>
        <script type="module">
            console.clear()
            const url = 'wss://worker-websockets.timkay.workers.dev/ws'
            const ws = new WebSocket(url)
            $(ws).on('close error message open', event => {
                say `= ${event.type}`
            })
            ws.addEventListener('open', event => {
                ws.send('Hello, World!!')
            })
            ws.addEventListener('message', ({data}) => {
                say `  data ${data}`
            })
            $('button#send').click(event => {
                ws.send('Send')
            })
            $('button#close').click(event => {
                ws.send('Close')
            })
        </script>

        // See https://developers.cloudflare.com/durable-objects/api/websockets/

    </body>
</html>