<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width">
        <link rel="icon" href="favicon.ico">
        <title>React Rerender</title>
    </head>
    <body>
        <div id="root"></div>
        <pre></pre>
        <script src="jquery.js"></script>
        <script src="https://unpkg.com/react@18.2.0/umd/react.development.js" crossorigin defer></script>
        <script src="https://unpkg.com/react-dom@18.2.0/umd/react-dom.development.js" crossorigin defer></script>
        <script src="https://unpkg.com/@babel/standalone@7.18.13/babel.min.js" defer></script>
        <script type="text/babel" data-presets="react, es2017">
            console.clear()
            const {useState, useEffect, memo} = React
            const Row = memo(({item}) => {
                return <tr>
                    <td>{item.value}</td>
                    <td>item render ms={Date.now() - now}</td>
                </tr>
            })
            const Items = ({items}) => {
                return <>
                    <br/>
                    Items render ms={Date.now() - now}
                    <div style={{border: 'thin solid blue', width: '100%', height: 400, overflow: 'auto'}}>
                        <table>
                            <tbody>
                                {items.map((item) => <Row key={item.key} item={item}/>)}
                            </tbody>
                        </table>
                    </div>
                </>
            }
            const App = () => {
                const [n, setN] = useState(100)
                const [items, setItems] = useState([
                    {key: 1, value: 'a'},
                    {key: 2, value: 2},
                    {key: 3, value: 'c'},
                    {key: 4, value: 4},
                    {key: 5, value: 'e'},
                    {key: 6, value: 'f'},
                ])
                const [duration, setDuration] = useState(0)
                useEffect(() => {
                    const items = []
                    for (let i = 0; i < n; i++) {
                        items.push({key: i + 1, value: i + 1})
                    }
                    setItems(items)
                }, [n])
                const reverse = () => {
                    const now = Date.now()
                    setItems((items) => [...items].reverse())
                    setDuration(Date.now() - now)
                }
                return  <div>
                            <h1>React Rerender</h1>
                            <p>When rerendering a table because order changed, does each element rerender?
                            NO. Not if you memoize each row. See:</p>
                            <p>
                                <a target="_blank" href="https://stackoverflow.com/a/64744993/24558">
                                    https://stackoverflow.com/a/64744993/24558
                                </a>
                                <br/>
                                <a target="_blank" href="https://stackoverflow.com/a/63405621/24558">
                                    https://stackoverflow.com/a/63405621/24558
                                </a>
                            </p>
                            <p>App render ms={Date.now() - now}</p>
                            n: <input value={n} onChange={event => setN(event.target.value)} style={{width: 50}}/>
                            <br/>
                            <button onClick={reverse}>reverse</button> {duration} ms
                            <Items items={items}/>
                        </div>
            }
            const now = Date.now()
            ReactDOM.createRoot(document.getElementById('root')).render(<App />)
        </script>
        <script src="weedit.js" async></script>
    </body>
</html>